GATE 0 — Bloqueadores Absolutos (GO / NO-GO)
Sem 100% de atendimento, produção é proibida.
0.1 Portabilidade e Runtime
✅ Build estático comprovado (CGO_ENABLED=0)
✅ Execução validada em Docker scratch
✅ Evidência explícita de execução (log ou comando reproduzível)
Motivo: sem isso, o binário não atende o contrato base de implantação.
0.2 Integridade de Faturamento
✅ Domínio Invoice/Faturamento explicitamente definido
✅ Persistência implementada (models, migrations, repositório)
❌ Nenhuma funcionalidade pode depender de “dados assumidos”
Motivo: hoje o Dashboard de Margem opera sobre uma abstração inexistente.
0.3 PDFs Operacionais (não placeholders)
✅ InvoicePDFTask implementada com dados reais
✅ BomPDFTask implementada com dados reais
✅ Uso efetivo de context.Context
✅ Timeout de 30s funcional
Motivo: PDF é saída operacional crítica (documento fiscal/industrial).
0.4 CT-03 — Cancelamento
✅ Evidência de que:
Encerramento de request cancela goroutine
PDF não continua processando após cancelamento
✅ Teste automatizado ou prova reproduzível
0.5 CT-04 — Graceful Shutdown
✅ WorkerPool:
Para de aceitar novas tarefas
Processa buffer pendente
Encerra em até 15s
✅ Evidência explícita (teste ou simulação controlada)


GATE 1 — Prontidão Operacional
Sistema pode ir para produção com risco controlado, mas não “enterprise-ready” sem isso.
1.1 WorkerPool Configurável
Workers e buffer via env
Nenhum valor hardcoded
1.2 Integração real de PDFs
Endpoint ou fluxo que:
Submeta tarefas ao WorkerPool
Propague contexto corretamente
1.3 CT-02 no Fluxo de Produção (BOM)
Lock pessimista validado no ProduceItem
Não apenas no estoque isolado
1.4 Observabilidade mínima
request_id propagado:
HTTP → usecase → worker
Logs correlacionáveis


GATE 2 — Robustez e Qualidade (recomendado)
Não bloqueia produção, mas gera débito operacional se ignorado.
2.1 Testes
Unit tests de usecases críticos:
Stock
BOM
Margin
Não apenas testes de integração
2.2 BOM Update Robusto
Update de componentes com:
add / remove / modify explícitos
Evitar dependência implícita de FullSaveAssociations
2.3 Produção com Bin explícito
Produção não deve assumir BinID = nil
Mesmo que haja default configurável
2.4 Circuit Breaker de e-mail
Retry simples
Backoff básico
Classificação de falha definitiva

Declaração Formal de “PRONTO PARA PRODUÇÃO”
O sistema só pode ser declarado “PRONTO PARA PRODUÇÃO” quando TODOS os itens do GATE 0 estiverem concluídos e evidenciados em SESSION_LOG auditável.
Gate 1 define qualidade operacional.
Gate 2 define maturidade de produto.